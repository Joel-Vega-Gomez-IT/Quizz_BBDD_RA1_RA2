<!--
  PARTS CONFIGURABLES DEL CODI:

  1. Bancs de preguntes:
     - Arrays 'preguntasRA1' i 'preguntasRA2' a l‚Äôinici de l‚Äôscript.
     - Cada pregunta t√©:
       - 'pregunta': text de la pregunta
       - 'opciones': array amb opcions de resposta
       - 'respuesta': √≠ndex (0-based) de l'opci√≥ correcta
     - Pots afegir, modificar o eliminar preguntes i opcions segons necessitis.

  2. Configuraci√≥ de selecci√≥ de RA:
     - Botons dins el div amb id="ra-buttons".
     - Opcions disponibles: 'ambos', 'ra1', 'ra2'.
     - Per afegir m√©s categories o canviar noms, modifica aquest grup i l√≤gica al script.

  3. Configuraci√≥ nombre de preguntes:
     - Botons dins el div amb id="numPreguntas-buttons".
     - Opcions: 10, 20, 30, 40, 50 i 'todas'.
     - Pots modificar, afegir o eliminar valors.

  4. L√≠mits per defecte:
     - Valor per defecte de 'totalPreguntas' (30).
     - Comprovaci√≥ que no es demanin m√©s preguntes de les disponibles.
     - Si vols canviar valors per defecte, modifica la variable 'totalPreguntas' o el codi al bot√≥ d'iniciar.

  5. Estils CSS:
     - Pots modificar colors, fonts i disposici√≥ dins la secci√≥ `<style>`.
     - Classes importants per respostes: 
       - .seleccionada (opci√≥ seleccionada)
       - .correcta (resposta correcta)
       - .incorrecta (resposta err√≤nia)
     - Botons i contenidors tenen classes i id per fer m√©s f√†cil la personalitzaci√≥.

  6. Textos de botons i missatges:
     - Textos com "Confirmar", "Seg√ºent", "Anterior", "Incorrecte", etc. estan dins l'HTML o l‚Äôscript.
     - Pots traduir o canviar aquests textos a la part HTML i dins les funcions JS.

  7. Funcionalitats:
     - Revisi√≥ de respostes despr√©s de finalitzar el quiz.
     - Reinici del quiz.
     - Barreja aleat√≤ria de preguntes (funci√≥ mezclarArray).
     - Limitaci√≥ de navegaci√≥ (botons anterior/seg√ºent).

  8. Estructura general:
     - Divs #config-container i #quiz-container separen la configuraci√≥ de la prova i la pr√≤pia prova.
     - Si vols afegir m√©s fases o canviar la navegaci√≥, modifica aquestes parts.

  -----------------------------------------------
  Per afegir preguntes noves, segueix l'estructura:

    {
      pregunta: "Text de la pregunta",
      opciones: ["Opci√≥ 1", "Opci√≥ 2", "Opci√≥ 3", "Opci√≥ 4"],
      respuesta: √≠ndex_de_la_opci√≥_correcta (0-based)
    }

  -----------------------------------------------
-->
<!DOCTYPE html>
<html lang="ca">
<head>
  <meta charset="UTF-8" />
  <title>Quiz RA1 / RA2 - Personalitzable</title>
  
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 600px;
      margin: 30px auto;
      padding: 10px;
      background-color: #333;
      color: #eee;
    }
    h1 {
      text-align: center;
    }
    .pregunta {
      font-size: 1.2em;
      margin-bottom: 15px;
    }
    button {
      display: block;
      width: 100%;
      margin: 8px 0;
      padding: 12px;
      font-size: 1em;
      cursor: pointer;
      border: 1px solid #eee;
      background-color: #333;
color: #eee;
      border-radius: 5px;
      transition: background-color 0.3s, transform 0.1s;
    }
    button:hover:not(:disabled) {
      background-color: #555;
    }
    button:disabled {
      cursor: default;
      opacity: 0.8;
    }

    .seleccionada { background-color: #41475e; border-color: #007bff; }
    .correcta { background-color: #28a745 !important; color: white; border-color: #1e7e34; }
    .incorrecta { background-color: #dc3545 !important; color: white; border-color: #b21f2d; }

    #resultat {
      margin-top: 25px;
      font-weight: bold;
      font-size: 1.1em;
    }
    #puntuatge {
      margin-top: 20px;
      font-size: 1.3em;
      text-align: center;
    }

    .nav-buttons {
      display: flex;
      justify-content: space-between;
      gap: 10px;
      margin-top: 20px;
    }

    .nav-buttons button { width: 48%; }

    #btnSeguent, #btnConfirmar, #btnAnterior, #btnRevision, #btnReiniciar, #btnIniciarQuiz {
      background-color: #007BFF;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }

    #btnReiniciar { background-color: #28a745; }

    #config-container {
      text-align: center;
      margin-top: 40px;
    }

    /* Estils per grups de botons de selecci√≥ */
    .grupo-botones {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 10px;
      margin: 15px 0 30px 0;
    }

    .grupo-botones button {
      width: 100px;
      padding: 10px;
      border-radius: 6px;
      border: 1px solid #eee;
      background-color: #333;
      color: #eee;
      transition: background-color 0.3s, color 0.3s;
    }

    .grupo-botones button.seleccionat {
      background-color: #007BFF;
      color: white;
      border-color: #0056b3;
    }

  </style>
</head>
<body>

  <h1>üòé Quizz de pr√†ctica BBDD üòé</h1>

  <!-- Pantalla de configuraci√≥ -->
  <div id="config-container">
    <h2>Configura el teu examen</h2>
    <p><b>Selecciona el RA:</b></p>
    <div id="ra-buttons" class="grupo-botones">
      <button data-value="ambos" class="seleccionat">Ambd√≥s</button>
      <button data-value="ra1">RA1</button>
      <button data-value="ra2">RA2</button>
    </div>

    <p><b>Quantes preguntes vols respondre?</b></p>
    <div id="numPreguntas-buttons" class="grupo-botones">
      <button data-value="10">10</button>
      <button data-value="20">20</button>
      <button data-value="30" class="seleccionat">30</button>
      <button data-value="40">40</button>
      <button data-value="50">50</button>
      <button data-value="todas">Totes</button>
    </div>

    <button id="btnIniciarQuiz">Iniciar Quiz</button>
  </div>

  <!-- Contenidor principal del quiz -->
  <div id="quiz-container" style="display:none;">
    <div id="pregunta" class="pregunta"></div>
    <div id="opciones"></div>
    <div id="resultat"></div>
    <button id="btnConfirmar" disabled>Confirmar</button>

    <div class="nav-buttons">
      <button id="btnAnterior" disabled>Anterior</button>
      <button id="btnSeguent" disabled>Seg√ºent</button>
    </div>

    <button id="btnRevision" style="display:none;">Revisar respostes</button>
    <button id="btnReiniciar" style="display:none;">Reiniciar Quiz</button>
  </div>

  <div id="puntuatge"></div>

<script>
  // üìò RA1: Banc de preguntes
  const preguntasRA1 = [    
{ pregunta: "Quina √©s la finalitat principal d'una base de dades?", opciones: ["Gestionar dades eficientment", "Crear programes", "Dissenyar hardware", "Programar en C++"], respuesta: 0 },
{ pregunta: "Quin acr√≤nim s'utilitza per Sistema Gestor de Bases de Dades?", opciones: ["SGBD", "SQL", "BD", "SGDB"], respuesta: 0 },
{ pregunta: "Quin pas √©s necessari per crear una base de dades amb SQL?", opciones: ["Dissenyar la BD", "Manipular la BD amb SQL", "Totes les anteriors", "Cap de les anteriors"], respuesta: 2 },
{ pregunta: "Quin tipus d'acc√©s t√© un fitxer seq√ºencial?", opciones: ["Acc√©s aleatori", "Acc√©s seq√ºencial", "Acc√©s per index", "Cap acc√©s"], respuesta: 1 },
{ pregunta: "Quin avantatge t√© l'acc√©s directe (Random Access)?", opciones: ["Acc√©s lent", "Acc√©s r√†pid", "No necessita programari espec√≠fic", "Sense avantatges"], respuesta: 1 },
{ pregunta: "Quina caracter√≠stica defineix un fitxer indexat?", opciones: ["Acc√©s aleatori per posici√≥", "Acc√©s basat en un index de claus", "Nom√©s lectura", "S'usa en piles"], respuesta: 1 },
{ pregunta: "Qu√® √©s l'esquema d'una base de dades?", opciones: ["Dades emmagatzemades", "Descripci√≥ de l'estructura de la BD", "Un tipus de fitxer", "Un programa SQL"], respuesta: 1 },
{ pregunta: "Quin nivell amaga com s'emmagatzemen f√≠sicament les dades?", opciones: ["Nivell L√≤gic", "Nivell F√≠sic", "Nivell Extern", "Nivell Conceptual"], respuesta: 0 },
{ pregunta: "Quin organisme va proposar els tres nivells de esquema el 1971?", opciones: ["ANSI", "CODASYL", "ISO", "IEEE"], respuesta: 1 },
{ pregunta: "Quin nivell de l'arquitectura ANSI/SPARC mostra la visi√≥ global de la base de dades?", opciones: ["Esquema extern", "Esquema conceptual", "Esquema f√≠sic", "Nivell l√≤gic"], respuesta: 1 },
{ pregunta: "Quin nivell cont√© la descripci√≥ de l'organitzaci√≥ f√≠sica de la BD?", opciones: ["Esquema extern", "Esquema conceptual", "Esquema intern/f√≠sic", "Esquema l√≤gic"], respuesta: 2 },
{ pregunta: "Quan es realitza un canvi al nivell intern sense afectar l'extern, qu√® s'ha produ√Øt?", opciones: ["Independ√®ncia l√≤gica", "Independ√®ncia f√≠sica", "Integritat referencial", "Cap canvi"], respuesta: 1 },
{ pregunta: "Quin √©s el primer pas que fa un SGBD quan rep una consulta?", opciones: ["Carregar dades a mem√≤ria", "Verificar sintaxi i permisos", "Enviar dades al programa", "Transformar dades externes"], respuesta: 1 },
{ pregunta: "Quina operaci√≥ de l'√†lgebra relacional combina totes les tuples de dues relacions?", opciones: ["Uni√≥", "Producte cartesi√†", "Selecci√≥", "Divisi√≥"], respuesta: 1 },
{ pregunta: "Quina operaci√≥ selecciona nom√©s les files que compleixen una condici√≥?", opciones: ["Selecci√≥ (œÉ)", "Projecci√≥ (œÄ)", "Join", "Divisi√≥"], respuesta: 0 },
{ pregunta: "Quina operaci√≥ extreu nom√©s determinades columnes d'una relaci√≥?", opciones: ["Selecci√≥", "Projecci√≥ (œÄ)", "Divisi√≥", "Producte cartesi√†"], respuesta: 1 },
{ pregunta: "Qu√® garanteixen les claus foranes (foreign keys)?", opciones: ["Integritat referencial", "Independ√®ncia f√≠sica", "Uni√≥ de tuples", "Duplicaci√≥ de dades"], respuesta: 0 },
{ pregunta: "Quina forma normal evita valors repetits en cel¬∑les?", opciones: ["1FN", "2FN", "3FN", "4FN"], respuesta: 0 },
{ pregunta: "Quina forma normal elimina depend√®ncies parcials de la clau prim√†ria?", opciones: ["1FN", "2FN", "3FN", "4FN"], respuesta: 1 },
{ pregunta: "Quina forma normal evita depend√®ncies entre columnes no clau?", opciones: ["1FN", "2FN", "3FN", "BCNF"], respuesta: 2 },
{ pregunta: "Quina √©s la principal caracter√≠stica d'una base de dades jer√†rquica?", opciones: ["Arbre invertit", "Taula amb columnes", "Claus foranes", "Uni√≥ de files"], respuesta: 0 },
{ pregunta: "Quin model es basa en la teoria de conjunts i la l√≤gica de predicats?", opciones: ["Jer√†rquic", "Relacional", "Xarxa", "Orientat a objectes"], respuesta: 1 },
{ pregunta: "Qu√® √©s una relaci√≥ en el model relacional?", opciones: ["Un arbre", "Una taula amb atributs i tuples", "Una columna", "Un registre f√≠sic"], respuesta: 1 },
{ pregunta: "Qu√® √©s un tuple en el model relacional?", opciones: ["Una fila d'una taula", "Una columna d'una taula", "Un √≠ndex", "Una base de dades"], respuesta: 0 },
{ pregunta: "Qu√® √©s la cardinalitat d'una relaci√≥?", opciones: ["Nombre de columnes", "Nombre de tuples", "Nom de la taula", "Clau prim√†ria"], respuesta: 1 },
{ pregunta: "Qu√® fa l'operaci√≥ de divisi√≥ (√∑) en √†lgebra relacional?", opciones: ["Uneix tuples amb condicions", "Selecciona tuples relacionades amb totes de l'altra relaci√≥", "Combina totes les tuples", "Filtra files per atribut"], respuesta: 1 },
{ pregunta: "Quin tipus de BBDD permet accedir a dades com si fossin una sola base de dades?", opciones: ["Centralitzada", "Distribu√Øda", "Fragmentada", "Replicada"], respuesta: 1 },
{ pregunta: "Quina regla ACID garanteix que una transacci√≥ sigui totalment completada o no?", opciones: ["Atomicitat", "Consist√®ncia", "A√Øllament", "Durabilitat"], respuesta: 0 },
{ pregunta: "Quina distribuci√≥ fa c√≤pies completes en cada node?", opciones: ["Centralitzada", "Replicada", "Fragmentada", "H√≠brida"], respuesta: 1 },
{ pregunta: "Quina distribuci√≥ fa que cada node emmagatzemi parts diferents de la BD?", opciones: ["Centralitzada", "Replicada", "Fragmentada", "H√≠brida"], respuesta: 2 },
{ pregunta: "Quina propietat garanteix que una clau for√†nia sempre apunti a una fila v√†lida?", opciones: ["Integritat referencial", "Independ√®ncia f√≠sica", "Divisi√≥ relacional", "Join"], respuesta: 0 },
{ pregunta: "Quin tipus d‚Äôintegritat fa que si K no √©s nul ha d'existir en S?", opciones: ["D√©bil", "Parcial", "Completa", "Total"], respuesta: 0 },
{ pregunta: "Quin tipus d‚Äôintegritat permet que alguns atributs de K siguin nuls?", opciones: ["D√©bil", "Parcial", "Completa", "Total"], respuesta: 1 },
{ pregunta: "Quina estructura de dades fa servir FIFO?", opciones: ["Pila (Stack)", "Arbre binari", "Cua (Queue)", "Llista enlla√ßada"], respuesta: 2 },
{ pregunta: "Quina operaci√≥ de l'√†lgebra relacional combina files que comparteixen atributs?", opciones: ["Selecci√≥", "Join", "Producte cartesi√†", "Projecci√≥"], respuesta: 1 },
{ pregunta: "Qu√® permet el principi d‚Äôinformaci√≥ en el model relacional?", opciones: ["Duplicar dades", "Representar tota la informaci√≥ mitjan√ßant tuples", "Eliminar claus", "Acc√©s f√≠sic directe"], respuesta: 1 },
{ pregunta: "Qu√® fa l'operaci√≥ de selecci√≥ en SQL equivalent?", opciones: ["WHERE", "SELECT", "JOIN", "GROUP BY"], respuesta: 0 },
{ pregunta: "Qu√® fa l'operaci√≥ de projecci√≥ en SQL equivalent?", opciones: ["WHERE", "SELECT", "JOIN", "GROUP BY"], respuesta: 1 },
{ pregunta: "Quin avantatge t√© una BD distribu√Øda?", opciones: ["Rapidesa i disponibilitat", "Complexitat alta", "Seguretat baixa", "Redund√†ncia total"], respuesta: 0 },
{ pregunta: "Quin desavantatge t√© una BD distribu√Øda?", opciones: ["Seguretat complexa", "R√†pida", "Disponible", "Modular"], respuesta: 0 },
{ pregunta: "Quin tipus de fitxer pot causar col¬∑lisions si s‚Äôusa hashing?", opciones: ["Seq√ºencial", "Acc√©s directe", "Indexat", "XML"], respuesta: 1 },
{ pregunta: "Quina operaci√≥ d'√†lgebra relacional retorna les tuples comunes a dues relacions?", opciones: ["Uni√≥", "Intersecci√≥", "Difer√®ncia", "Producte cartesi√†"], respuesta: 1 },
{ pregunta: "Quina operaci√≥ retorna tuples que estan en T1 per√≤ no en T2?", opciones: ["Uni√≥", "Intersecci√≥", "Difer√®ncia", "Join"], respuesta: 2 },
{ pregunta: "Quina persona defineix l'esquema conceptual d'una BD?", opciones: ["Usuari final", "ABD (Administrador de BD)", "Programador", "SGBD"], respuesta: 1 },
{ pregunta: "Quin nivell extern permet modificar noms i atributs segons les necessitats de l'usuari?", opciones: ["Esquema extern", "Esquema conceptual", "Esquema intern", "Esquema f√≠sic"], respuesta: 0 },
{ pregunta: "Qu√® fa l'operaci√≥ d'assignaci√≥ (:=) en √†lgebra relacional?", opciones: ["Assigna un nom a una nova relaci√≥", "Combina dues relacions", "Filtra files", "Elimina columnes"], respuesta: 0 },
{ pregunta: "Quin avantatge t√© un fitxer indexat respecte al seq√ºencial?", opciones: ["M√©s flexible i r√†pid", "M√©s lent", "No necessita index", "Nom√©s lectura"], respuesta: 0 },
{ pregunta: "Quina √©s la unitat m√≠nima d‚Äôinformaci√≥ en una relaci√≥?", opciones: ["Atribut", "Tuple", "Relvar", "Esquema"], respuesta: 1 },
{ pregunta: "Quina regla evita que es cre√Øn factures amb DNI inexistents?", opciones: ["Integritat referencial", "1FN", "Join", "Divisi√≥"], respuesta: 0 },
{ pregunta: "Quina estructura utilitza nodes sense pare i fulles per emmagatzemar dades?", opciones: ["Xarxa", "Jer√†rquica", "Relacional", "Indexada"], respuesta: 1 },
{ pregunta: "Quin model permet tipus de dades abstractes i orientaci√≥ a objectes?", opciones: ["Jer√†rquic", "Relacional orientat a objectes", "Xarxa", "Relacional"], respuesta: 1 },
{ pregunta: "Quin nivell en ANSI/SPARC respon a preguntes de rendiment?", opciones: ["Externe", "Conceptual", "Intern/F√≠sic", "L√≤gic"], respuesta: 2 },
{ pregunta: "Quin llenguatge s'utilitza per crear i manipular BDs relacionals?", opciones: ["HTML", "SQL", "Python", "C++"], respuesta: 1 },
{ pregunta: "Qu√® fa l‚Äôoperaci√≥ Join natural?", opciones: ["Uneix files amb atributs comuns", "Combina totes les files", "Filtra columnes", "Assigna noms a relacions"], respuesta: 0 },
{ pregunta: "Qu√® fa l‚ÄôOuter Join?", opciones: ["Mant√© tamb√© les files sense correspond√®ncia", "Combina totes les files", "Filtra tuples amb condicions", "Crea index"], respuesta: 0 },
{ pregunta: "Qu√® significa que una base de dades √©s consistent?", opciones: ["Totes les restriccions s√≥n certes", "Totes les restriccions s√≥n falses", "Hi ha duplicaci√≥ de dades", "Hi ha errors de SQL"], respuesta: 0 },
{ pregunta: "En qu√® consisteix el concepte d‚Äôindepend√®ncia f√≠sica de les dades en una arquitectura de tres nivells?", opciones: ["Els canvis a l'esquema intern no afecten l'esquema extern ni conceptual", "Els canvis l√≤gics no afecten cap nivell", "El SGBD controla totes les consultes", "Les dades es repliquen autom√†ticament"], respuesta: 0 },
{ pregunta: "En qu√® consisteix el concepte d‚Äôindepend√®ncia l√≤gica de les dades en una arquitectura de tres nivells?", opciones: ["Els canvis a l'esquema conceptual no afecten els esquemes externs", "Els canvis f√≠sics afecten totes les consultes", "Els usuaris no poden veure les dades", "El SGBD elimina dades duplicades"], respuesta: 0 },
{ pregunta: "Quins tipus d'atributs clau es fan servir en una base de dades?", opciones: ["Clau prim√†ria i clau forana", "Nom√©s clau secund√†ria", "Index i punter", "Columnes i tuples"], respuesta: 0 },
{ pregunta: "A qu√® es refereix el concepte de mantenir la integritat referencial?", opciones: ["Que una clau forana sempre apunta a una fila v√†lida en la taula referenciada", "Que les dades es poden eliminar lliurement", "Que els √≠ndexs es reben autom√†ticament", "Que totes les consultes s√≥n r√†pides"], respuesta: 0 },
{ pregunta: "Qu√® va definir l‚Äôest√†ndard ANSI/SPARC de bases de dades?", opciones: ["Una arquitectura de tres nivells per separar vista d'usuari i organitzaci√≥ f√≠sica", "El llenguatge SQL", "Els tipus de fitxers indexats", "El model relacional orientat a objectes"], respuesta: 0 },
{ pregunta: "Nomena cinc models de bases de dades", opciones: ["Jer√†rquic, Xarxa, Relacional, Relacional orientat a objectes, Distribu√Øt", "SQL, MySQL, Oracle, PostgreSQL, MongoDB", "Indexat, Seq√ºencial, Aleatori, Hash, XML", "Extern, Conceptual, Intern, F√≠sic, L√≤gic"], respuesta: 0 },
{ pregunta: "Quina difer√®ncia hi ha entre un fitxer indexat i un d‚Äôacc√©s directe?", opciones: ["L‚Äôindexat usa un index per trobar registres, l‚Äôacc√©s directe usa posici√≥", "No hi ha difer√®ncia", "L‚Äôacc√©s directe √©s m√©s lent que l‚Äôindexat", "L‚Äôindexat no permet consultar dades"], respuesta: 0 },
{ pregunta: "Explica dos avantatges de les bases de dades distribu√Ødes", opciones: ["Rapidesa i disponibilitat", "Seguretat baixa i complexitat", "Redund√†ncia i cost alt", "√önic lloc de dades"], respuesta: 0 },
{ pregunta: "Explica dos inconvenients de les bases de dades distribu√Ødes", opciones: ["Complexitat i seguretat complicada", "R√†pida i disponible", "Modular i barata", "Centralitzada i replicada"], respuesta: 0 },
{ pregunta: "Quina √©s la finalitat d‚Äôun SGBD?", opciones: ["Permetre crear, emmagatzemar i manipular dades de manera eficient", "Fer gr√†fics i presentacions", "Programar en Java", "Gestionar sistemes operatius"], respuesta: 0 },
{ pregunta: "Explica tres operacions de l‚Äô√†lgebra relacional", opciones: ["Selecci√≥ (œÉ), Projecci√≥ (œÄ), Join (‚®ù)", "INSERT, UPDATE, DELETE", "CREATE, DROP, ALTER", "Union, Difer√®ncia, Multiplicaci√≥ de matrius"], respuesta: 0 }
  ];

  // üìó RA2: Banc de preguntes
  const preguntasRA2 = [
    { pregunta: "Qu√® significa JSON?", opciones: ["JavaScript Object Notation", "Java Standard Object Network", "Just Simple Object Naming", "Joint Source Online Network"], respuesta: 0 },
    { pregunta: "Quina paraula clau defineix una constant a JavaScript?", opciones: ["let", "const", "var", "define"], respuesta: 1 },
    { pregunta: "Quin operador s'usa per comparar igualtat estricta a JS?", opciones: ["==", "===", "=", "!="], respuesta: 1 },
    { pregunta: "Quin llenguatge s'usa principalment per bases de dades?", opciones: ["Python", "SQL", "HTML", "C#"], respuesta: 1 },
    { pregunta: "Quin comandament inicia un repositori Git?", opciones: ["git start", "git init", "git open", "git create"], respuesta: 1 },
  ];

  // üìö Variables globals
  let preguntas = [];
  let totalPreguntas = 30;
  let preguntaActual = 0;
  let puntaje = 0;
  let respuestasUsuario = [];
  let modoRevision = false;
  let opcionSeleccionada = null;

  // üì¶ Elements del DOM
  const configContainer = document.getElementById('config-container');
  const raButtons = document.getElementById('ra-buttons');
  const numPreguntasButtons = document.getElementById('numPreguntas-buttons');
  const btnIniciarQuiz = document.getElementById('btnIniciarQuiz');

  const quizContainer = document.getElementById('quiz-container');
  const preguntaEl = document.getElementById('pregunta');
  const opcionesEl = document.getElementById('opciones');
  const resultatEl = document.getElementById('resultat');
  const btnConfirmar = document.getElementById('btnConfirmar');
  const btnSeguent = document.getElementById('btnSeguent');
  const btnAnterior = document.getElementById('btnAnterior');
  const btnRevision = document.getElementById('btnRevision');
  const btnReiniciar = document.getElementById('btnReiniciar');
  const puntuatgeEl = document.getElementById('puntuatge');

  // Funcions per manejar selecci√≥ botons configuraci√≥
  function seleccionarBotonEnGrupo(container, boton) {
    const botones = container.querySelectorAll('button');
    botones.forEach(b => b.classList.remove('seleccionat'));
    boton.classList.add('seleccionat');
  }

  // Esdeveniment per selecci√≥ RA
  raButtons.addEventListener('click', e => {
    if (e.target.tagName === 'BUTTON') {
      seleccionarBotonEnGrupo(raButtons, e.target);
    }
  });

  // Esdeveniment per selecci√≥ nombre de preguntes
  numPreguntasButtons.addEventListener('click', e => {
    if (e.target.tagName === 'BUTTON') {
      seleccionarBotonEnGrupo(numPreguntasButtons, e.target);
    }
  });

  // üß© Funci√≥ per barrejar aleat√≤riament un array
  function mezclarArray(array) {
    for (let i = array.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [array[i], array[j]] = [array[j], array[i]];
    }
  }

  // üé¨ Inici del quiz despr√©s de configurar
  btnIniciarQuiz.addEventListener('click', () => {
    const raElegit = raButtons.querySelector('button.seleccionat').getAttribute('data-value');
    const cantidadStr = numPreguntasButtons.querySelector('button.seleccionat').getAttribute('data-value');

    // Seleccionar banc de preguntes segons RA
    if (raElegit === "ra1") {
      preguntas = [...preguntasRA1];
    } else if (raElegit === "ra2") {
      preguntas = [...preguntasRA2];
    } else {
      preguntas = [...preguntasRA1, ...preguntasRA2];
    }

    // Barrejar
    mezclarArray(preguntas);

    // Quantitat preguntes segons selecci√≥
    if (cantidadStr === 'todas') {
      totalPreguntas = preguntas.length;
    } else {
      const cantidad = parseInt(cantidadStr);
      totalPreguntas = (!isNaN(cantidad) && cantidad > 0) ? Math.min(cantidad, preguntas.length) : Math.min(30, preguntas.length);
    }

    preguntas = preguntas.slice(0, totalPreguntas);

    // Canviar a vista quiz
    configContainer.style.display = "none";
    quizContainer.style.display = "block";

    iniciarQuiz();
  });

  // üöÄ L√≤gica del quiz
  function iniciarQuiz() {
    preguntaActual = 0;
    puntaje = 0;
    respuestasUsuario = Array(totalPreguntas).fill(null);
    modoRevision = false;
    btnRevision.style.display = "none";
    btnReiniciar.style.display = "none";
    btnAnterior.style.display = "block";
    btnSeguent.style.display = "block";
    mostrarPregunta();
  }

  function mostrarPregunta() {
    const pregunta = preguntas[preguntaActual];
    const respuesta = respuestasUsuario[preguntaActual];

    preguntaEl.textContent = `Pregunta ${preguntaActual + 1} de ${totalPreguntas}: ${pregunta.pregunta}`;
    opcionesEl.innerHTML = "";
    resultatEl.textContent = "";
    btnConfirmar.disabled = true;

    pregunta.opciones.forEach((opcion, index) => {
      const btn = document.createElement('button');
      btn.textContent = opcion;
      btn.addEventListener('click', () => seleccionarOpcion(index, btn));
      opcionesEl.appendChild(btn);
    });

    if (respuesta) {
      const botones = opcionesEl.querySelectorAll('button');
      botones.forEach(b => b.disabled = true);
      botones[respuesta.correctaIndex].classList.add('correcta');
      if (!respuesta.correcto) {
        botones[respuesta.seleccionadaIndex].classList.add('incorrecta');
        resultatEl.textContent = `Incorrecte ‚ùå. La resposta correcta √©s: ${pregunta.opciones[pregunta.respuesta]}`;
      } else {
        resultatEl.textContent = "Correcte! ü§ô";
      }
      btnConfirmar.disabled = true;
    }

    btnAnterior.disabled = preguntaActual === 0;
    btnSeguent.disabled = !respuesta;

    if (modoRevision) {
      btnConfirmar.style.display = "none";
      btnSeguent.textContent = preguntaActual === totalPreguntas - 1 ? "Finalitzar revisi√≥" : "Seg√ºent";
      btnSeguent.disabled = false;
    } else {
      btnConfirmar.style.display = "block";
      btnSeguent.textContent = preguntaActual === totalPreguntas - 1 ? "Finalitzar" : "Seg√ºent";
    }
  }

  function seleccionarOpcion(index, btn) {
    if (respuestasUsuario[preguntaActual]) return;
    const botones = opcionesEl.querySelectorAll('button');
    botones.forEach(b => b.classList.remove('seleccionada'));
    btn.classList.add('seleccionada');
    opcionSeleccionada = index;
    btnConfirmar.disabled = false;
  }

  btnConfirmar.addEventListener('click', () => {
    if (opcionSeleccionada === null) return;
    const pregunta = preguntas[preguntaActual];
    const botones = opcionesEl.querySelectorAll('button');
    botones.forEach(b => b.disabled = true);

    const correcto = opcionSeleccionada === pregunta.respuesta;

    if (correcto) {
      botones[opcionSeleccionada].classList.remove('seleccionada');
      botones[opcionSeleccionada].classList.add('correcta');
      resultatEl.textContent = "Correcte! ü§ô";
      puntaje++;
    } else {
      botones[opcionSeleccionada].classList.remove('seleccionada');
      botones[opcionSeleccionada].classList.add('incorrecta');
      botones[pregunta.respuesta].classList.add('correcta');
      resultatEl.textContent = `Incorrecte ‚ùå. La resposta correcta √©s: ${pregunta.opciones[pregunta.respuesta]}`;
    }

    respuestasUsuario[preguntaActual] = {
      seleccionadaIndex: opcionSeleccionada,
      correctaIndex: pregunta.respuesta,
      correcto
    };

    btnConfirmar.disabled = true;
    btnSeguent.disabled = false;
  });

  btnSeguent.addEventListener('click', () => {
    if (modoRevision) {
      if (preguntaActual < totalPreguntas - 1) {
        preguntaActual++;
        mostrarPregunta();
      } else {
        mostrarResultados();
      }
      return;
    }

    if (preguntaActual < totalPreguntas - 1) {
      preguntaActual++;
      opcionSeleccionada = null;
      mostrarPregunta();
    } else {
      mostrarResultados();
    }
  });

  btnAnterior.addEventListener('click', () => {
    if (preguntaActual > 0) {
      preguntaActual--;
      opcionSeleccionada = null;
      mostrarPregunta();
    }
  });

  function mostrarResultados() {
    modoRevision = false;
    preguntaEl.textContent = "Quiz acabat!";
    opcionesEl.innerHTML = "";
    resultatEl.innerHTML = "";

    let resultadoHTML = "<h2>Resultats:</h2><ul>";
    respuestasUsuario.forEach((r, i) => {
      const p = preguntas[i];
      resultadoHTML += `<li><b>Pregunta ${i + 1}:</b> ${p.pregunta}<br>
        La teva resposta: ${p.opciones[r.seleccionadaIndex]} ${r.correcto ? "‚úÖ" : "‚ùå"}<br>
        Resposta correcta: ${p.opciones[r.correctaIndex]}</li><br>`;
    });
    resultadoHTML += "</ul>";

    resultatEl.innerHTML = resultadoHTML;
    puntuatgeEl.textContent = `Puntuaci√≥ final: ${puntaje} de ${totalPreguntas}`;

    btnConfirmar.style.display = "none";
    btnAnterior.style.display = "none";
    btnSeguent.style.display = "none";
    btnRevision.style.display = "block";
    btnReiniciar.style.display = "block";
  }

  btnRevision.addEventListener('click', () => {
    modoRevision = true;
    preguntaActual = 0;
    btnRevision.style.display = "none";
    btnReiniciar.style.display = "none";
    btnAnterior.style.display = "block";
    btnSeguent.style.display = "block";
    mostrarPregunta();
  });

  btnReiniciar.addEventListener('click', () => location.reload());

</script>

</body>
</html>

